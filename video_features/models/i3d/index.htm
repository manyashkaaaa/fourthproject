
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.2">
    
    
      
        <title>I3D (RGB + Flow) - Video Features Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.9f9400aa.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
        <link rel="stylesheet" href="../../../css-1?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#i3d-rgb-flow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.htm" title="Video Features Documentation" class="md-header__button md-logo" aria-label="Video Features Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Video Features Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              I3D (RGB + Flow)
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required="">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix="">
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/v-iashin/video_features" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.htm" title="Video Features Documentation" class="md-nav__button md-logo" aria-label="Video Features Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>

    </a>
    Video Features Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/v-iashin/video_features" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix="">
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../index.htm" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2">
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Meta
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Meta" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Meta
        </label>
        <ul class="md-nav__list" data-md-scrollfix="">
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../meta/docker/index.htm" class="md-nav__link">
        Docker support
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked="">
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Models" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix="">
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../clip/index.htm" class="md-nav__link">
        CLIP
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          I3D (RGB + Flow)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.htm" class="md-nav__link md-nav__link--active">
        I3D (RGB + Flow)
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
      
        <li class="md-nav__item">
  <a href="#supported-arguments" class="md-nav__link">
    Supported Arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-the-environment-for-i3d" class="md-nav__link">
    Set up the Environment for I3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    Quick Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#credits" class="md-nav__link">
    Credits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pwc/index.htm" class="md-nav__link">
        PWC-Net
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../r21d/index.htm" class="md-nav__link">
        R(2+1)D
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../raft/index.htm" class="md-nav__link">
        RAFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../resnet/index.htm" class="md-nav__link">
        ResNet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../s3d/index.htm" class="md-nav__link">
        S3D
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vggish/index.htm" class="md-nav__link">
        VGGish
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
      
        <li class="md-nav__item">
  <a href="#supported-arguments" class="md-nav__link">
    Supported Arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-the-environment-for-i3d" class="md-nav__link">
    Set up the Environment for I3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    Quick Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#credits" class="md-nav__link">
    Credits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/v-iashin/video_features/edit/master/docs/models/i3d.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg>
  </a>


<h1 id="i3d-rgb-flow">I3D (RGB + Flow)</h1>
<figure>
  <img src="../../_assets/i3d.png" width="300">
</figure>

<p>The <em>Inflated 3D (<a href="https://arxiv.org/abs/1705.07750">I3D</a>)</em> features are extracted using
a pre-trained model on <a href="https://deepmind.com/research/open-source/kinetics">Kinetics 400</a>.
Here, the features are extracted from the second-to-the-last layer of I3D, before summing them up.
Therefore, it outputs two tensors with 1024-d features: for RGB and flow streams.
By default, it expects to input 64 RGB and flow frames (<code>224x224</code>) which spans 2.56 seconds of the video recorded at 25 fps.
In the default case, the features will be of size <code>Tv x 1024</code> where <code>Tv = duration / 2.56</code>.</p>
<p>Please note, this implementation uses either <a href="https://arxiv.org/abs/1709.02371">PWC-Net</a> (the default)
and <a href="https://arxiv.org/abs/2003.12039">RAFT</a> optical flow extraction instead of the TV-L1 algorithm,
which was used in the original I3D paper as it hampers speed.
Yet, it might possibly lead to worse peformance. Our tests show that the performance is reasonable.
You may test it yourself by providing <code>--show_pred</code> flag.</p>
<div class="admonition warning">
<p class="admonition-title">CUDA 11 and GPUs like RTX 3090 and newer</p>
<p>PWC optical flow back-end is not supported on CUDA 11 and, therefore, GPUs like <strong>RTX 3090</strong> and newer.
RGB-only model should still work.
For details please check this <a href="https://github.com/v-iashin/video_features/issues/13">issue #13</a>
If you were able to fix it, please share your workaround.
Feel free to use <code>flow_type=raft</code> <a href="../raft/index.htm">RAFT</a> during extraction.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">The PWC-Net does NOT support using CPU currently</p>
<p>The PWC-Net uses <code>cupy</code> module, which makes it difficult to turn to a version that does not use the GPU.
However, if you have solution, you may submit a PR.</p>
</div>
<hr>
<h2 id="supported-arguments">Supported Arguments</h2>
<!-- the <div> makes columns wider -->
<table>
<thead>
<tr>
<th><div style="width: 12em">Argument</div></th>
<th><div style="width: 8em">Default</div></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>stack_size</code></td>
<td><code>64</code></td>
<td>The number of frames from which to extract features (or window size).</td>
</tr>
<tr>
<td><code>step_size</code></td>
<td><code>64</code></td>
<td>The number of frames to step before extracting the next features.</td>
</tr>
<tr>
<td><code>streams</code></td>
<td><code>null</code></td>
<td>I3D is a two-stream network. By default (<code>null</code> or omitted) both RGB and flow streams are used. To use RGB- or flow-only models use <code>rgb</code> or <code>flow</code>.</td>
</tr>
<tr>
<td><code>flow_type</code></td>
<td><code>pwc</code></td>
<td>By default, the flow-features of I3D will be calculated using optical from calculated with PWCNet (originally with TV-L1). Another supported model is <code>raft</code>.</td>
</tr>
<tr>
<td><code>extraction_fps</code></td>
<td><code>null</code></td>
<td>If specified (e.g. as <code>5</code>), the video will be re-encoded to the <code>extraction_fps</code> fps. Leave unspecified or <code>null</code> to skip re-encoding.</td>
</tr>
<tr>
<td><code>device</code></td>
<td><code>"cuda:0"</code></td>
<td>The device specification. It follows the PyTorch style. Use <code>"cuda:3"</code> for the 4th GPU on the machine or <code>"cpu"</code> for CPU-only.</td>
</tr>
<tr>
<td><code>video_paths</code></td>
<td><code>null</code></td>
<td>A list of videos for feature extraction. E.g. <code>"[./sample/v_ZNVhz7ctTq0.mp4, ./sample/v_GGSY1Qvo990.mp4]"</code> or just one path <code>"./sample/v_GGSY1Qvo990.mp4"</code>.</td>
</tr>
<tr>
<td><code>file_with_video_paths</code></td>
<td><code>null</code></td>
<td>A path to a text file with video paths (one path per line). Hint: given a folder <code>./dataset</code> with <code>.mp4</code> files one could use: <code>find ./dataset -name "*mp4" &gt; ./video_paths.txt</code>.</td>
</tr>
<tr>
<td><code>on_extraction</code></td>
<td><code>print</code></td>
<td>If <code>print</code>, the features are printed to the terminal. If <code>save_numpy</code> or <code>save_pickle</code>, the features are saved to either <code>.npy</code> file or <code>.pkl</code>.</td>
</tr>
<tr>
<td><code>output_path</code></td>
<td><code>"./output"</code></td>
<td>A path to a folder for storing the extracted features (if <code>on_extraction</code> is either <code>save_numpy</code> or <code>save_pickle</code>).</td>
</tr>
<tr>
<td><code>keep_tmp_files</code></td>
<td><code>false</code></td>
<td>If <code>true</code>, the reencoded videos will be kept in <code>tmp_path</code>.</td>
</tr>
<tr>
<td><code>tmp_path</code></td>
<td><code>"./tmp"</code></td>
<td>A path to a folder for storing temporal files (e.g. reencoded videos).</td>
</tr>
<tr>
<td><code>show_pred</code></td>
<td><code>false</code></td>
<td>If <code>true</code>, the script will print the predictions of the model on a down-stream task. It is useful for debugging.</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="set-up-the-environment-for-i3d">Set up the Environment for I3D</h2>
<p>Depending on whether you would like to use PWC-Net or RAFT for optical flow extraction,
you will need to install separate conda environments – <code>conda_env_pwc.yml</code> and <code>conda_env_torch_zoo</code>, respectively</p>
<pre><code class="language-bash"># it will create a new conda environment called 'pwc' on your machine
conda env create -f conda_env_pwc.yml
# or/and if you would like to extract optical flow with RAFT
conda env create -f conda_env_torch_zoo.yml
</code></pre>
<hr>
<h2 id="quick-start">Quick Start</h2>
<p><a href="https://colab.research.google.com/drive/1LKoytZmNxtC-EuCp7pHDM6sFvK1XdwlW?usp=sharing"><img alt="Open In Colab" src="../../../assets/colab-badge.svg"></a></p>
<p>Activate the environment</p>
<pre><code class="language-bash">conda activate pwc
</code></pre>
<p>if you would like to use RAFT as optical flow extractor use <code>torch_zoo</code> instead of <code>pwc</code>:</p>
<p>and extract features from <code>./sample/v_ZNVhz7ctTq0.mp4</code> video and show the predicted classes</p>
<pre><code class="language-bash">python main.py \
    feature_type=i3d \
    device=&quot;cuda:0&quot; \
    video_paths=&quot;[./sample/v_ZNVhz7ctTq0.mp4]&quot; \
    show_pred=true
</code></pre>
<hr>
<h2 id="examples">Examples</h2>
<p>Activate the environment</p>
<pre><code class="language-bash">conda activate pwc
</code></pre>
<p>The following will extract I3D features for sample videos.
The features are going to be extracted with the default parameters.</p>
<pre><code class="language-bash">python main.py \
    feature_type=i3d \
    device=&quot;cuda:0&quot; \
    video_paths=&quot;[./sample/v_ZNVhz7ctTq0.mp4, ./sample/v_GGSY1Qvo990.mp4]&quot;
</code></pre>
<p>The video paths can be specified as a <code>.txt</code> file with paths</p>
<pre><code class="language-bash">python main.py \
    feature_type=i3d \
    device=&quot;cuda:0&quot; \
    file_with_video_paths=./sample/sample_video_paths.txt
</code></pre>
<p>It is also possible to extract features from either <code>rgb</code> or <code>flow</code> modalities individually (<code>--streams</code>)
and, therefore, increasing the speed</p>
<pre><code class="language-bash">python main.py \
    feature_type=i3d \
    streams=flow \
    device=&quot;cuda:0&quot; \
    file_with_video_paths=./sample/sample_video_paths.txt
</code></pre>
<p>To extract optical flow frames using RAFT approach, specify <code>--flow_type raft</code>.
Note that using RAFT will make the extraction slower than with PWC-Net yet visual inspection of extracted flow
frames suggests that RAFT has a better quality of the estimated flow</p>
<pre><code class="language-bash"># make sure to activate the correct environment (`torch_zoo`)
# conda activate torch_zoo
python main.py \
    feature_type=i3d \
    flow_type=raft \
    device=&quot;cuda:0&quot; \
    file_with_video_paths=./sample/sample_video_paths.txt
</code></pre>
<p>The features can be saved as numpy arrays by specifying <code>--on_extraction save_numpy</code> or <code>save_pickle</code>.
By default, it will create a folder <code>./output</code> and will store features there</p>
<pre><code class="language-bash">python main.py \
    feature_type=i3d \
    device=&quot;cuda:0&quot; \
    on_extraction=save_numpy \
    file_with_video_paths=./sample/sample_video_paths.txt
</code></pre>
<p>You can change the output folder using <code>--output_path</code> argument.</p>
<p>Also, you may want to try to change I3D window and step sizes</p>
<pre><code class="language-bash">python main.py \
    feature_type=i3d \
    device=&quot;cuda:0&quot; \
    stack_size=24 \
    step_size=24 \
    file_with_video_paths=./sample/sample_video_paths.txt
</code></pre>
<p>By default, the frames are extracted according to the original fps of a video. If you would like to extract frames at a certain fps, specify <code>--extraction_fps</code> argument.</p>
<pre><code class="language-bash">python main.py \
    feature_type=i3d \
    device=&quot;cuda:0&quot; \
    extraction_fps=25 \
    stack_size=24 \
    step_size=24 \
    file_with_video_paths=./sample/sample_video_paths.txt
</code></pre>
<p>A fun note, the time span of the I3D features in the last example will match the time span of VGGish features
with default parameters (24/25 = 0.96).</p>
<p>If <code>--keep_tmp_files</code> is specified, it keeps them in <code>--tmp_path</code> which is <code>./tmp</code> by default.
Be careful with the <code>--keep_tmp_files</code> argument when playing with <code>--extraction_fps</code> as it may mess up the
frames you extracted before in the same folder.</p>
<hr>
<h2 id="credits">Credits</h2>
<ol>
<li><a href="https://github.com/sniklaus/pytorch-pwc/tree/f6138900578214ab4e3daef6743b88f7824293be">An implementation of PWC-Net in PyTorch</a></li>
<li>The <a href="https://github.com/princeton-vl/RAFT/tree/25eb2ac723c36865c636c9d1f497af8023981868">Official RAFT implementation (esp. <code>./demo.py</code>)</a>.</li>
<li><a href="https://github.com/hassony2/kinetics_i3d_pytorch">A port of I3D weights from TensorFlow to PyTorch</a></li>
<li>The I3D paper: <a href="https://arxiv.org/abs/1705.07750">Quo Vadis, Action Recognition? A New Model and the Kinetics Dataset</a>.</li>
</ol>
<hr>
<h2 id="license">License</h2>
<p>The wrapping code is MIT and the port of I3D weights from TensorFlow to PyTorch. However, PWC Net (default flow extractor) has <a href="https://github.com/sniklaus/pytorch-pwc/blob/f6138900578214ab4e3daef6743b88f7824293be/LICENSE">GPL-3.0</a> and RAFT <a href="https://github.com/princeton-vl/RAFT/blob/25eb2ac723c36865c636c9d1f497af8023981868/LICENSE">BSD 3-Clause</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../clip/index.htm" class="md-footer__link md-footer__link--prev" aria-label="Previous: CLIP" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              CLIP
            </div>
          </div>
        </a>
      
      
        
        <a href="../pwc/index.htm" class="md-footer__link md-footer__link--next" aria-label="Next: PWC-Net" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              PWC-Net
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.39f04ddb.min.js"></script>
      
    
  </body>
</html>